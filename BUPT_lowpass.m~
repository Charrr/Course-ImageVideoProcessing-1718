function [ OUT ] = BUPT_lowpass( IN, size, a )
%5a Convolves an image with a Gaussian kernel.
%   Input:
%       IN: input matrix
%       size: size of the Gaussian filter
%       factor: up-sampling factor
%   Output:
%       OUT: output matrix

figure,
subplot(3,1,1), imshow(uint8(IN)); title('Original image');

Inoisy = imnoise(IN,'gaussian', 0, 0.50);
subplot(3,1,2), imshow(uint8(Inoisy)); title('Original image');

if length(size)==2
    siz = (size-1)/2;
else
    siz = [(size-1)/2 (size-1)/2];
end

std2 = a^2;
[x, y] = meshgrid(-siz(2):siz(2),-siz(1):siz(1));
arg   = -(x.*x + y.*y)/(2*std2);
T     = exp(arg);
T(T<eps*max(T(:))) = 0;
sumh = sum(T(:));

if sumh ~= 0,
    T  = T/sumh;
end

OUT = imfilter(I,T,'symmetric');
subplot(3,1,3), imshow(uint8(Inoisy)); title('Original image');

end

